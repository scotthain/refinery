name: Release the refinery binaries
on: [push, merge]
jobs:
  go-build:
    runs-on: ubuntu-latest #,darwin
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Go build
          run |
            GOOS=<< parameters.fos >> \
            GOARCH=<< parameters.arch >> \
            go build -ldflags "-X main.BuildID=${CIRCLE_TAG:-${CIRCLE_SHA1:0:7}}" \
            -o $GOPATH/bin/refinery-<< parameters.os >>-<< parameters.arch >> \
            ./cmd/refinery
      - name: Get Shasum
          run |
            256sum $GOPATH/bin/refinery-<< parameters.os >>-<< parameters.arch >> \
            \> $GOPATH/bin/refinery-<< parameters.os >>-<< parameters.arch >>.checksum

  setup_googlekoq:
    runs-on: ubuntu-latest #,darwin
    steps:
      -name: Install ko
        run: go install github.com/google/ko@latest
    
  
  

# jobs:
#   dfstest:
#     docker:
#       - image: cimg/go:1.18
#       - image: redis:6
#     steps:
# f f     - checkout

  
  
  
  
        # with:
        #   github_token: ${{ secrets.GHPROJECTS_TOKEN }}
        #   repo: honeycombio/helm-charts
        #   title: Bump Refinery to Latest Version
        #   body: |
        #     ## Bump Refinery

        #     Update Refinery to latest version

        #   labels: |
        #     type: dependencies
        #     status: oncall
